职业定位

- 面向增长与留存的前端架构负责人：以依赖注入（DI）+ 作用域隔离（ServerScope）为基石，结合全链路可观测与回退策略，沉淀可复用的工程治理体系，支撑团队协作商业化、跨端一致与多服务器自托管交付。

产品增长视角（架构如何驱动业务）

- 自托管与运维控制台｜可运营、可审计、可规模化
  - 问题域：自托管/企业交付需统一配置、认证、审计；权限与缓存分散，无法批量查询和处理，排障慢、回滚风险高。
  - 架构策略：
    - 认证会话：服务端 Session；/api/auth/session 统一用户态；Cookie 自动携带/恢复；x-affine-version 统一上报。
    - 配置权限：前端 DI + ServerScope 覆盖云端/自托管差异；后端 NestJS DI 统一 OAuth/配置/许可。
    - 状态缓存：GlobalState 单一真相；LiveData+backoffRetry 统一重试与失效；GraphQLService/FetchService 统一读写。
    - 许可审计：License 安装/校验；Admin 面板支持用户导入导出、禁用、版本检查等。
  - 业务价值：开箱自部署、可观测可回滚；许可与审计增强采购与续费确定性。

- 协作与分享链路｜外部扩散与回流
  - 问题域：邀请/登录/权限/升级的长链路易出错且不能批量邀请，影响被邀请用户转化与团队扩容。
  - 架构策略：将“邀请→登录→接受→权限与成员生效”拆为前端状态机与可恢复中间态；错误页/过期态/未登录态明确引导；分享页基于会话态与权限呈现只读/可编辑差异；关键节点埋点与版本头贯通定位。
  - 业务价值：提升邀请成功率与团队升级完成率，提升用户留存，减少超限误报与工单。

- 商业化闭环｜订阅/配额/席位/权限一致性
  - 问题域：计费/配额/权限割裂导致误跳转与错误提示，付费墙提示不清晰。
  - 架构策略：Workspace Billing 与 Quota 面板统一数据口径；成员编辑与权限变更后端强校验、前端及时刷新；不同服务器/环境通过 DI 作用域隔离接口差异，保证一致体验。
  - 业务价值：升级/续费链路更顺畅，投诉与误报显著下降。

- Editor Settings 平台化｜集中配置与一致体验
  - 问题域：page 和 edgeless 中各种编辑器设置分散在多处、读写口径不一，跨端与多服务器默认值漂移，上手难度高，可访问性低。
  - 架构策略：
    - Settings 平台化：收敛为集中 Settings 模块（GlobalState + DI/ServerScope），统一读写与默认值，并提供演示。
    - 既有能力接入：将Edgeless 主题、字体等既有能力接入集中配置，提供迁移适配层，避免一次性破坏性改造。
    - 一致性保障：跨端（Web/Electron/移动）与多服务器通过 Scope 覆盖差异实现，确保默认值与落盘一致，行为可预期。
  - 业务价值：消除多处状态与行为漂移，跨端/多服务器一致，回归面更小，开箱默认体验更好，减少工单与培训成本。

- Onboarding 与国际化｜获客覆盖与首日转化
  - 问题域：多语言不一致与入口分散降低首日体验。
  - 架构策略：i18n 抽包、i18next-scanner 自动提取、键值自动同步；语言本地存储与入口切换；公共页与导航统一文案治理。
  - 业务价值：扩大自然获客覆盖、缩短上手路径、提升注册与首日留存。

- 信息组织与核心 UX｜可预期、低摩擦的日常效率
  - 问题域：侧边栏与导航的抖动与消失；页面前进后退滚动位置、树展开折叠状态混乱与丢失，客户端不可拖动等。
  - 架构策略：DI + 状态持久化统一侧边栏实例管理；滚动位置/树展开状态在路由层与数据层协同恢复；弱网/窄屏场景用去抖与安全卸载顺序消除竞态。
  - 业务价值：稳定的可预期交互，提升日常留存与任务完成效率。

精选技能（对齐实际栈）

- 前端与架构：TypeScript、React、依赖注入（DI 容器、作用域/覆盖）、复杂交互与状态持久化、跨端一致性治理（Web/Electron/移动）。
- 数据与状态：GraphQL（查询/上传/突变）、REST、GlobalState/Lite Store、LiveData（Rx 管道、backoffRetry）、Signals。
- 商业化与运维：多服务器/自托管交付、License/Feature Flag 抽象、Admin 治理与导入导出、埋点与版本治理（x-affine-version）。
- 工程与质量：模块化扩展（Extension）、可观测性、错误中间态与幂等重试、测试用 DI 替换/覆盖、灰度与回滚预案。
